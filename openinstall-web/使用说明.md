# OpenInstall Web 使用说明

## 🌐 网站地址

**已部署地址：** https://openinstall-web.vercel.app/

## 📖 使用方法

### 1. 基本 URL 格式

在 URL 后面添加参数来传递追踪信息：

```
https://openinstall-web.vercel.app/?inviteCode=ABC123&channelId=channel1&userId=user123
```

### 2. URL 参数说明

| 参数 | 说明 | 示例 | 必填 |
|------|------|------|------|
| `inviteCode` | 邀请码 | `ABC123` | 否 |
| `channelId` | 渠道ID | `channel1` | 否 |
| `userId` | 用户ID | `user123` | 否 |
| `custom` | 自定义参数 | `custom_data` | 否 |

### 3. 使用场景示例

#### 场景 1: 分享邀请链接

```
https://openinstall-web.vercel.app/?inviteCode=INVITE001
```

用户点击后：
1. 页面自动收集设备指纹
2. 将邀请码和设备指纹上传到后端
3. 用户点击"立即下载"按钮
4. 如果已安装 App，会尝试拉起 App
5. 如果未安装，跳转到应用商店下载

#### 场景 2: 渠道推广

```
https://openinstall-web.vercel.app/?channelId=wechat&inviteCode=WX001
```

#### 场景 3: 用户推荐

```
https://openinstall-web.vercel.app/?userId=user123&inviteCode=REF001
```

## 🔄 工作流程

```
用户点击分享链接
    ↓
打开网页，自动收集设备指纹
    ↓
上传设备指纹 + URL参数到后端
    ↓
用户点击"立即下载"
    ↓
尝试拉起已安装的 App（如果已安装）
    ↓
如果未安装，跳转到应用商店
    ↓
用户安装 App 后打开
    ↓
App 收集设备指纹并查询后端
    ↓
后端匹配设备指纹，返回追踪参数
    ↓
App 获取到邀请码/渠道ID等参数
```

## ⚙️ 配置说明

在部署前，需要修改 `index.html` 中的 `CONFIG` 配置：

```javascript
const CONFIG = {
    apiBaseUrl: 'https://openinstall-backend.zeabur.app/api',  // ✅ 已配置
    appScheme: 'yourapp://',                                   // ⚠️ 需要修改
    universalLink: 'https://yourdomain.com',                  // ⚠️ 需要修改
    iosAppStoreUrl: 'https://apps.apple.com/app/your-app',    // ⚠️ 需要修改
    androidDownloadUrl: 'https://your-server.com/download/app.apk'  // ⚠️ 需要修改
};
```

### 需要配置的项目：

1. **appScheme**: 你的 App 的 URL Scheme
   - iOS: 在 `Info.plist` 中配置
   - Android: 在 `AndroidManifest.xml` 中配置
   - 示例：`myapp://` 或 `com.example.app://`

2. **universalLink**: Universal Link 域名（iOS）
   - 需要配置 Apple App Site Association 文件
   - 示例：`https://yourdomain.com`

3. **iosAppStoreUrl**: iOS App Store 链接
   - 示例：`https://apps.apple.com/app/id123456789`

4. **androidDownloadUrl**: Android APK 下载链接
   - 可以是直接下载链接或应用商店链接
   - 示例：`https://play.google.com/store/apps/details?id=com.example.app`

## 🧪 测试方法

### 1. 测试 URL 参数解析

访问：
```
https://openinstall-web.vercel.app/?inviteCode=TEST123&channelId=test&userId=testuser
```

应该能看到：
- 邀请码：TEST123
- 渠道：test
- 用户ID：testuser

### 2. 测试设备指纹上传

打开浏览器开发者工具（F12）→ Console，应该能看到：
- "数据上传成功" 或错误信息

### 3. 测试 App 拉起

1. 确保已安装你的 App
2. 点击"立即下载"按钮
3. 应该能自动打开 App

## 📱 与 Flutter App 集成

1. **分享链接时**：使用带参数的网页链接
   ```
   https://openinstall-web.vercel.app/?inviteCode=XXX
   ```

2. **App 启动时**：调用 SDK 获取参数
   ```dart
   OpenInstall().init();
   final params = await OpenInstall().getInstallParams();
   if (params?.inviteCode != null) {
       // 处理邀请码
   }
   ```

3. **匹配流程**：
   - 网页收集设备指纹 → 上传到后端
   - App 收集设备指纹 → 查询后端
   - 后端匹配相同的设备指纹 → 返回追踪参数

## 🔍 常见问题

### Q: 为什么显示"加载中..."？

A: 可能是：
1. 后端 API 连接失败（检查网络或后端地址）
2. 浏览器控制台可能有错误信息
3. 检查后端服务是否正常运行

### Q: 如何查看是否上传成功？

A: 打开浏览器开发者工具（F12）→ Console，查看日志

### Q: App 无法拉起怎么办？

A: 检查：
1. `appScheme` 配置是否正确
2. App 是否已正确配置 URL Scheme
3. Universal Link 是否已配置（iOS）

### Q: 如何自定义页面样式？

A: 修改 `index.html` 中的 CSS 样式部分

## 📞 技术支持

如有问题，请检查：
1. 浏览器控制台的错误信息
2. 后端 API 是否正常响应
3. 网络连接是否正常

