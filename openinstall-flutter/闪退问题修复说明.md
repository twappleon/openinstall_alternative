# APK é—ªé€€é—®é¢˜ä¿®å¤è¯´æ˜

## ğŸ”§ å·²ä¿®å¤çš„é—®é¢˜

### 1. æ·»åŠ å…¨å±€é”™è¯¯å¤„ç†
- æ·»åŠ äº† `FlutterError.onError` å¤„ç† Flutter æ¡†æ¶é”™è¯¯
- æ·»åŠ äº† `PlatformDispatcher.instance.onError` å¤„ç†å¼‚æ­¥é”™è¯¯
- æ‰€æœ‰é”™è¯¯éƒ½ä¼šåœ¨æ§åˆ¶å°è¾“å‡ºï¼Œæ–¹ä¾¿è°ƒè¯•

### 2. æ”¹è¿›åˆå§‹åŒ–æµç¨‹
- ä½¿ç”¨ `addPostFrameCallback` ç¡®ä¿ widget å®Œå…¨æ„å»ºåå†åˆå§‹åŒ–
- å»¶è¿Ÿ 500ms å†è·å–å®‰è£…å‚æ•°ï¼Œé¿å…é˜»å¡ UI
- æ·»åŠ  `mounted` æ£€æŸ¥ï¼Œé˜²æ­¢åœ¨ widget dispose åè°ƒç”¨ `setState`

### 3. æ·»åŠ è¶…æ—¶å¤„ç†
- ç½‘ç»œè¯·æ±‚æ·»åŠ  10 ç§’è¶…æ—¶
- è¶…æ—¶åè¿”å› nullï¼Œä¸ä¼šå¯¼è‡´å´©æºƒ

### 4. å¢å¼ºé”™è¯¯å¤„ç†
- æ‰€æœ‰å¼‚æ­¥æ“ä½œéƒ½æ·»åŠ äº† try-catch
- è®¾å¤‡ä¿¡æ¯è·å–å¤±è´¥æ—¶ä½¿ç”¨é»˜è®¤å€¼
- æ·»åŠ å †æ ˆè·Ÿè¸ªè¾“å‡ºï¼Œæ–¹ä¾¿å®šä½é—®é¢˜

## ğŸ§ª æµ‹è¯•æ­¥éª¤

### 1. é‡æ–°æ„å»º APK

```bash
cd openinstall-flutter/example
flutter clean
flutter build apk
```

### 2. å®‰è£…å¹¶æµ‹è¯•

1. å¸è½½æ—§ç‰ˆæœ¬ï¼ˆå¦‚æœå·²å®‰è£…ï¼‰
2. å®‰è£…æ–°æ„å»ºçš„ APK
3. å¯åŠ¨åº”ç”¨ï¼Œè§‚å¯Ÿæ˜¯å¦è¿˜ä¼šé—ªé€€

### 3. æŸ¥çœ‹æ—¥å¿—

å¦‚æœä»ç„¶é—ªé€€ï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼æŸ¥çœ‹æ—¥å¿—ï¼š

#### æ–¹æ³• 1: ä½¿ç”¨ adb logcat

```bash
# è¿æ¥è®¾å¤‡å
adb logcat | grep -E "flutter|openinstall|AndroidRuntime"
```

#### æ–¹æ³• 2: ä½¿ç”¨ Flutter æ—¥å¿—

```bash
flutter logs
```

#### æ–¹æ³• 3: åœ¨ Android Studio ä¸­æŸ¥çœ‹

1. æ‰“å¼€ Android Studio
2. è¿æ¥è®¾å¤‡
3. è¿è¡Œåº”ç”¨
4. æŸ¥çœ‹ Logcat çª—å£

## ğŸ” å¸¸è§é—ªé€€åŸå› 

### 1. ç½‘ç»œè¯·æ±‚å¤±è´¥
**ç—‡çŠ¶ï¼š** åº”ç”¨å¯åŠ¨åç«‹å³é—ªé€€ï¼Œæ—¥å¿—æ˜¾ç¤ºç½‘ç»œé”™è¯¯

**è§£å†³ï¼š**
- æ£€æŸ¥ç½‘ç»œè¿æ¥
- æ£€æŸ¥åç«¯ API æ˜¯å¦å¯è®¿é—®
- æ£€æŸ¥é˜²ç«å¢™è®¾ç½®

### 2. è®¾å¤‡ä¿¡æ¯è·å–å¤±è´¥
**ç—‡çŠ¶ï¼š** æ—¥å¿—æ˜¾ç¤ºè®¾å¤‡ä¿¡æ¯è·å–å¼‚å¸¸

**è§£å†³ï¼š**
- å·²æ·»åŠ é”™è¯¯å¤„ç†ï¼Œä½¿ç”¨é»˜è®¤å€¼
- å¦‚æœä»æœ‰é—®é¢˜ï¼Œæ£€æŸ¥è®¾å¤‡æƒé™

### 3. åŸç”Ÿæ’ä»¶é—®é¢˜
**ç—‡çŠ¶ï¼š** æ—¥å¿—æ˜¾ç¤º MethodChannel è°ƒç”¨å¤±è´¥

**è§£å†³ï¼š**
- æ£€æŸ¥åŸç”Ÿæ’ä»¶ä»£ç 
- æ£€æŸ¥ AndroidManifest.xml é…ç½®

### 4. å†…å­˜ä¸è¶³
**ç—‡çŠ¶ï¼š** åº”ç”¨å¯åŠ¨æ—¶å†…å­˜ä¸è¶³

**è§£å†³ï¼š**
- å…³é—­å…¶ä»–åº”ç”¨
- æ£€æŸ¥è®¾å¤‡å¯ç”¨å†…å­˜

## ğŸ“± è°ƒè¯•æŠ€å·§

### 1. å¯ç”¨è¯¦ç»†æ—¥å¿—

åœ¨ `main.dart` ä¸­ï¼Œç¡®ä¿ `kDebugMode` ä¸º trueï¼š

```dart
if (kDebugMode) {
  print('Flutter Error: ${details.exception}');
}
```

### 2. ä½¿ç”¨æ–­ç‚¹è°ƒè¯•

1. åœ¨ Android Studio ä¸­æ‰“å¼€é¡¹ç›®
2. åœ¨å…³é”®ä½ç½®è®¾ç½®æ–­ç‚¹
3. ä»¥ Debug æ¨¡å¼è¿è¡Œ

### 3. æ£€æŸ¥ç½‘ç»œè¯·æ±‚

åœ¨ `tracking_api.dart` ä¸­æ·»åŠ æ›´è¯¦ç»†çš„æ—¥å¿—ï¼š

```dart
print('è¯·æ±‚ URL: $baseUrl/tracking/get');
print('è¯·æ±‚ä½“: $requestBody');
print('å“åº”çŠ¶æ€: ${response.statusCode}');
print('å“åº”ä½“: ${response.body}');
```

## ğŸ› ï¸ å¦‚æœä»ç„¶é—ªé€€

### æ­¥éª¤ 1: æ”¶é›†æ—¥å¿—

```bash
# æ¸…é™¤æ—§æ—¥å¿—
adb logcat -c

# å¯åŠ¨åº”ç”¨
adb shell am start -n com.openinstall.flutter.example/.MainActivity

# æ”¶é›†æ—¥å¿—
adb logcat > crash_log.txt
```

### æ­¥éª¤ 2: åˆ†ææ—¥å¿—

æŸ¥æ‰¾ä»¥ä¸‹å…³é”®è¯ï¼š
- `FATAL EXCEPTION`
- `AndroidRuntime`
- `flutter`
- `openinstall`
- `Exception`

### æ­¥éª¤ 3: ç®€åŒ–æµ‹è¯•

åˆ›å»ºä¸€ä¸ªæœ€å°æµ‹è¯•ç‰ˆæœ¬ï¼Œåªæ˜¾ç¤º UIï¼Œä¸è°ƒç”¨ä»»ä½• APIï¼š

```dart
void main() {
  runApp(MaterialApp(
    home: Scaffold(
      body: Center(child: Text('æµ‹è¯•')),
    ),
  ));
}
```

å¦‚æœè¿™ä¸ªç‰ˆæœ¬ä¸é—ªé€€ï¼Œè¯´æ˜é—®é¢˜åœ¨ä¸šåŠ¡é€»è¾‘ä¸­ã€‚

## ğŸ“‹ æ£€æŸ¥æ¸…å•

- [ ] å·²æ·»åŠ å…¨å±€é”™è¯¯å¤„ç†
- [ ] å·²æ·»åŠ è¶…æ—¶å¤„ç†
- [ ] å·²æ·»åŠ  mounted æ£€æŸ¥
- [ ] å·²æ·»åŠ è®¾å¤‡ä¿¡æ¯é”™è¯¯å¤„ç†
- [ ] å·²é‡æ–°æ„å»º APK
- [ ] å·²æµ‹è¯•å®‰è£…å’Œå¯åŠ¨
- [ ] å·²æŸ¥çœ‹æ—¥å¿—è¾“å‡º

## ğŸ”— ç›¸å…³æ–‡ä»¶

- `example/lib/main.dart` - ä¸»åº”ç”¨å…¥å£
- `lib/src/services/fingerprint_service.dart` - è®¾å¤‡æŒ‡çº¹æœåŠ¡
- `lib/src/services/tracking_api.dart` - API æœåŠ¡
- `android/src/main/kotlin/com/openinstall/flutter/OpenInstallPlugin.kt` - åŸç”Ÿæ’ä»¶

